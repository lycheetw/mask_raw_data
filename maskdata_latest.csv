<!DOCTYPE html>
<html>
    <head>
        <title>存取被拒。</title>
        <meta name="viewport" content="width=device-width" />
        <style>
         body {font-family:"Verdana";font-weight:normal;font-size: .7em;color:black;} 
         p {font-family:"Verdana";font-weight:normal;color:black;margin-top: -5px}
         b {font-family:"Verdana";font-weight:bold;color:black;margin-top: -5px}
         H1 { font-family:"Verdana";font-weight:normal;font-size:18pt;color:red }
         H2 { font-family:"Verdana";font-weight:normal;font-size:14pt;color:maroon }
         pre {font-family:"Consolas","Lucida Console",Monospace;font-size:11pt;margin:0;padding:0.5em;line-height:14pt}
         .marker {font-weight: bold; color: black;text-decoration: none;}
         .version {color: gray;}
         .error {margin-bottom: 10px;}
         .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; }
         @media screen and (max-width: 639px) {
          pre { width: 440px; overflow: auto; white-space: pre-wrap; word-wrap: break-word; }
         }
         @media screen and (max-width: 479px) {
          pre { width: 280px; }
         }
        </style>
    </head>

    <body bgcolor="white">

            <span><H1>'/' 應用程式中發生伺服器錯誤。<hr width=100% size=1 color=silver></H1>

            <h2> <i>存取被拒。</i> </h2></span>

            <font face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ">

            <b> 描述: </b>在執行目前 Web 要求的過程中發生未處理的例外狀況。請檢閱堆疊追蹤以取得錯誤的詳細資訊，以及在程式碼中產生的位置。

            <br><br>

            <b> 例外狀況詳細資訊: </b>System.ComponentModel.Win32Exception: 存取被拒。<br><br>

            <b>原始程式錯誤:</b> <br><br>

            <table width=100% bgcolor="#ffffcc">
               <tr>
                  <td>
                      <code>

只有在偵錯模式編譯時，才可以顯示產生此未處理例外狀況的原始程式碼。若要啟動，請依照下列步驟之一，然後要求 URL:<br><br>1. 將 &quot;Debug=true&quot; 指示詞加入產生錯誤的程式碼頂端。例如:<br><br> &nbsp;&nbsp;&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; %&gt;<br><br>或:<br><br>2. 將下列區段加入您應用程式的組態檔:<br><br>&lt;configuration&gt;<br> &nbsp;&nbsp;&nbsp;&lt;system.web&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;compilation debug=&quot;true&quot;/&gt;<br> &nbsp;&nbsp;&nbsp;&lt;/system.web&gt;<br>&lt;/configuration&gt;<br><br>請注意: 第二種技巧會導致在偵錯模式下編譯指定應用程式中的所有檔案。第一種技巧只會造成在偵錯模式下編譯該特定檔案。<br><br>重要資訊: 在偵錯模式下執行應用程式會過度耗用記憶體/效能。在實際執行部署之前，應該先確認應用程式已經停止偵錯。</code>

                  </td>
               </tr>
            </table>

            <br>

            <b>堆疊追蹤:</b> <br><br>

            <table width=100% bgcolor="#ffffcc">
               <tr>
                  <td>
                      <code><pre>

[Win32Exception (0x80004005): 存取被拒。]

[SqlException (0x80131904): 建立連接至 SQL Server 時，發生網路相關或執行個體特定的錯誤。找不到或無法存取伺服器。確認執行個名稱是否正確，以及 SQL Server 是否設定為允許遠端連線。 (provider: Named Pipes Provider, error: 40 - 無法開啟至 SQL Server 的連接)]
   System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal&amp; connection) +1338
   System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal&amp; connection) +159
   System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal&amp; connection) +382
   System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions) +307
   System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry) +198
   System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry) +422
   System.Data.SqlClient.SqlConnection.Open() +199
   PSTCOM.Data.SQLHelper.PrepareCommand(SqlCommand cmd, SqlConnection conn, SqlTransaction trans, CommandType cmdType, String cmdText, SqlParameter[] cmdParms, Nullable`1 cmdTimeout) in D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs:636
   PSTCOM.Data.SQLHelper.ExecuteDataSet(SqlConnection connection, CommandType cmdType, String cmdText, Nullable`1 cmdTimeout, SqlParameter[] commandParameters) in D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs:571
   PSTCOM.Data.SQLHelper.ExecuteDataSet(String connectionString, CommandType cmdType, String cmdText, SqlParameter[] commandParameters) in D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs:509
   NhiOpenDataPub.DataAccess.DatasetResourceRepository.GetByID(String resourceId) in D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\DataAccess\DatasetResourceRepository.cs:53
   NhiOpenDataPub.DataAccess.DatasetResourceRepository.GetEntityByID(String resourceId) in D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\DataAccess\DatasetResourceRepository.cs:59
   NhiOpenDataPub.BusinessLogic.DatasetResouceBL.ValidDownloadRequest(String resourceId, String locationUrl, String remoteIP) in D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\BusinessLogic\DatasetResouceBL.cs:109
   Download.ProcessRequest(HttpContext context) +347
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +866
   System.Web.HttpApplication.ExecuteStepImpl(IExecutionStep step) +213
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +91
</pre></code>

                  </td>
               </tr>
            </table>

            <br>

            <hr width=100% size=1 color=silver>

            <b>版本資訊:</b>&nbsp;Microsoft .NET Framework 版本:4.0.30319; ASP.NET 版本:4.7.3535.0

            </font>

    </body>
</html>
<!-- 
[Win32Exception]: 存取被拒。
[SqlException]: 建立連接至 SQL Server 時，發生網路相關或執行個體特定的錯誤。找不到或無法存取伺服器。確認執行個名稱是否正確，以及 SQL Server 是否設定為允許遠端連線。 (provider: Named Pipes Provider, error: 40 - 無法開啟至 SQL Server 的連接)
   於 System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   於 System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   於 System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   於 System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   於 System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   於 System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   於 System.Data.SqlClient.SqlConnection.Open()
   於 PSTCOM.Data.SQLHelper.PrepareCommand(SqlCommand cmd, SqlConnection conn, SqlTransaction trans, CommandType cmdType, String cmdText, SqlParameter[] cmdParms, Nullable`1 cmdTimeout) 於 D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs: 行 636
   於 PSTCOM.Data.SQLHelper.ExecuteDataSet(SqlConnection connection, CommandType cmdType, String cmdText, Nullable`1 cmdTimeout, SqlParameter[] commandParameters) 於 D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs: 行 571
   於 PSTCOM.Data.SQLHelper.ExecuteDataSet(String connectionString, CommandType cmdType, String cmdText, SqlParameter[] commandParameters) 於 D:\PSTProjSys\PSTCOMNET\src\app\PSTCOM.NET\Data\SQLHelper.cs: 行 509
   於 NhiOpenDataPub.DataAccess.DatasetResourceRepository.GetByID(String resourceId) 於 D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\DataAccess\DatasetResourceRepository.cs: 行 53
   於 NhiOpenDataPub.DataAccess.DatasetResourceRepository.GetEntityByID(String resourceId) 於 D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\DataAccess\DatasetResourceRepository.cs: 行 59
   於 NhiOpenDataPub.BusinessLogic.DatasetResouceBL.ValidDownloadRequest(String resourceId, String locationUrl, String remoteIP) 於 D:\4健保OpenData\新版控\trunk\src\app\NhiOpenDataPub\BusinessLogic\DatasetResouceBL.cs: 行 109
   於 Download.ProcessRequest(HttpContext context)
   於 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   於 System.Web.HttpApplication.ExecuteStepImpl(IExecutionStep step)
   於 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
--><!-- 
此錯誤頁面可能包含敏感性資料，因為 ASP.NET 是設定成使用 &lt;customErrors mode="Off"/&gt; 顯示詳細資訊錯誤訊息。請考慮在實際執行環境中使用 &lt;customErrors mode="On"/&gt; 或 &lt;customErrors mode="RemoteOnly"/&gt;。-->